<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
    <!--<link rel="icon" href="favicon.ico" sizes="16x16" type="image/ico">
	-->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
	<title>APA6</title>

    <!-- Bootstrap -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>

    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<style>
	body {
		background-color: #F9F9F9;
	}
	.bg-brand {
		background-color: #00A6D6;
	}
	.white {
		color: #FFFFFF;
	}
	.bordered {
	    border: 1px solid black;
	    padding: 3px;
	    text-align: left;
	    border-collapse: collapse;
		font-family: "Times New Roman", Times, serif;
		font-size: .85em;
	}
	#toggleExample:hover {
		cursor: pointer;
	}
	.container {
		max-width: 800px;
	}
	.example {
		max-width: 640px;
	}
	</style>
</head>
<body>
	<div id="data-style"></div>
	<div class="container">
		<div class="row bg-brand">
			<div class="col-xs-3"><img src="http://vkc.library.tudelft.nl/fileadmin/templates/images/tudelft-logo-transparant-275x80.png" height="35" width="70"></div>
			<div class="col-xs-9 h2 white">APA6 Citation style</div>
		</div>
		<div class="row">
			<div class="col-xs-10">
				<div class="row">
					<div id="headingoptions-title" class="col-xs-offset-1 col-xs-3"><h3>Heading</h3></div>
					<div id="typeoptions-title" class="col-xs-offset-1 col-xs-3"><h3>Type</h3></div>
					<div id="combinationoptions-title" class="col-xs-offset-1 col-xs-3"><h3>See also</h3></div>
				</div> 
				<div class="row">
					<div id="headingoptions" class="col-xs-offset-1 col-xs-3">heading list</div>
					<div id="typeoptions" class="col-xs-offset-1 col-xs-3">type list</div>
					<div id="combinationoptions" class="col-xs-offset-1 col-xs-3">combination list</div>
				</div>
				<div class="row">
					<div class="col-xs-12"><br></div>
				</div> 
			</div>
		</div>
		<div class="row">
			<div class="col-xs-12">
				<div class="panel panel-info example">
					<div class="panel-heading panel-title">In-text example</div>
					<div id="in-text-example" class="panel-body">Hier het voorbeeld</div>
				</div>
			</div>	
		</div>
		<div class="row">
			<div class="col-xs-12">
				<div class="panel panel-info example">
					<div class="panel-heading panel-title">Reference list example</div>
					<div id="reference-list-example" class="panel-body">Hier het voorbeeld</div>
				</div>
			</div>	
		</div>
		<div class="row">
			<div class="col-xs-12">
				<div class="panel panel-info example">
					<div class="panel-heading panel-title">Figure example</div>
					<div id="figure-heading-example" class="panel-body">Hier het voorbeeld</div>
				</div>
			</div>	
		</div>
		<div class="row">
			<div class="col-xs-12">
				<div class="panel panel-info example">
					<div class="panel-heading panel-title">Remark</div>
					<div id="remark" class="panel-body">Hier het voorbeeld</div>
				</div>
			</div>	
		</div>
	</div>
	Stappen:
	<ol>
		<li>
			Bestaand apa6 bestand, via Excel -> save as HTML -> inlezen via de Choose File knop <span id="toggleExample">(Klik hier voor een voorbeeld)</span><span id="example">
			<table class="bordered">
				<tr><td class="bordered">Heading</td><td class="bordered">Types</td><td class="bordered">In-text example</td><td class="bordered">Reference list example</td><td class="bordered">Remark</td></tr>
				<tr><td class="bordered">Books</td><td class="bordered">Paper book</td><td class="bordered">Dorf (2006, p. 51)</td><td class="bordered">Dorf, R. C. (2006). The electrical engineering handbook (3rd ed.). Boca Raton, FL: CRC/Taylor & Francis.</td><td class="bordered">Place information about editions, volume numbers, and page numbers in parentheses with the period after the parentheses: (Rev. ed.). or (Vol. xx, pp. xxx-xxx).</td></tr>
			</table>
			</span>
		</li>
	</ol>
	</br>
	<br>
	<div id="dvImportSegments" class="fileupload ">
	    <fieldset>
	        <legend>Upload your CSV File</legend>
	            <input type="file" name="File Upload" id="txtFileUpload" accept=".htm" />
	   </fieldset>
	</div>
	
	<div id="result"></div>

<script>
	// start get key number from header name
	function nameToKey(headerData, myName) {
		var result = -1;
		$.each(headerData, function(index, value) {
			if (myName == value) {
				result = index;
			};
		});
		return result;
	}
	// end get key number from header name
</script>

<script>
	// global data
	var apaContent = "";		// holds the apaContent
	var referenceHeight = 0;	// holds and keeps the first measured height of the reference example field, see $(document).ready() 
	var prevHeight = 0;			// holds the height of the reference example field, see wrapReferenceExample
</script>

<script>
	function getSortedContentWithChangedId(data) {
		var headingKey = nameToKey(data.header, "Heading");
		var typesKey = nameToKey(data.header, "Types");
		var headingRankingKey = nameToKey(data.header, "Ranking headings");
		var typeRankingKey = nameToKey(data.header, "Ranking types");
		var delimiter = "-=avdk2017=-";
		var content = [];
		var sortingArray = [];
		
		var headingArray = [];
        var typesPerHeading = {};
		var typesArray = [];
		var uniqueSortedTypesPerHeading = {};
		
		// start sorting on ranking
		$.each($(data.content), function(key, value) {
			var sortKey = pad(value[headingRankingKey], 3) + delimiter + pad(value[typeRankingKey], 3) + delimiter + value[headingKey] + delimiter + value[typesKey];
			sortingArray.push(sortKey);
		});
		
		// ... is a spread operator
		sortingArray = [...sortingArray].sort((a, b) => a.localeCompare(b));
		// end sorting on ranking

		var previousHeading = '';
		for (i = 0; i < sortingArray.length; i++) {
			var myHeading = sortingArray[i].split(delimiter)[2];
			headingArray.push(myHeading);
			if (myHeading != previousHeading) {
				typesPerHeading[myHeading] = [];
				previousHeading = myHeading;			
			}
			typesPerHeading[myHeading].push(sortingArray[i].split(delimiter)[2] + delimiter + sortingArray[i].split(delimiter)[3]);
		};

		var uniqueSortedHeadings = [...new Set(headingArray)];															// unique heading
		
		for (i = 0; i < uniqueSortedHeadings.length; i++) {
			var myHeading = uniqueSortedHeadings[i];
			uniqueSortedTypesPerHeading[myHeading] = [...new Set(typesPerHeading[myHeading])];							// unique sorting type per heading
		}
		
		// start id hier opnieuw bepalen
		var idHeading = "";
		var idTypes = "";
		$.each($(data.content), function(key, value) {
			idHeading = uniqueSortedHeadings.indexOf(value[headingKey]);
			idTypes = uniqueSortedTypesPerHeading[value[headingKey]].indexOf( value[headingKey] + delimiter + value[typesKey] );
			data.content[key].id = pad(idHeading, 3) + "_" + pad(idTypes, 3);
		});
		// end id hier opnieuw bepalen

		// start sort again, but now on id
		sortingArray = [];
		$.each($(data.content), function(key, value) {
			sortingArray.push(value.id);
		});
		
		// ... is a spread operator
		sortingArray = [...sortingArray].sort((a, b) => a.localeCompare(b));
		// end sort again, but now on id
		
		var content = [];
		for (i = 0; i < sortingArray.length; i++) {
			$.each($(data.content), function(key, value) {
				if (sortingArray[i] == value.id) {
					content.push(value);
				}
			});
		};
		data.content = content;	
		return data;
	}
</script>

<script>
	function filterInput(line) {
		var myLine = line;
		myLine = myLine.replace(/^\s+/g, "");		// remove 2 or more space at the beginning of a line
		myLine = myLine.replace(/\s+/g, " ");		// replace 2 or more space with 1 space 
		//myLine = myLine.replace(/&amp;/g,"");		// remove &amp;
		myLine = myLine.replace(/&nbsp;/g,"");		// remove &nbsp;
		myLine = myLine.replace(/\t/g,"");			// remove tabs
		myLine = myLine.replace(/\n/g,"");			// remove newlines
		//myLine = myLine.replace(/ \(.*?\)/g,"");	// remove everything between <space>(brackets),
		//   Secondary sources,Unp<span style='display:none'>ublished work</span></td>
		myLine = myLine.replace(/.span style=.display:none..(.*?)..span./g,"$1");	// removes the display:none span and preserves the text
		myLine = myLine.replace(/="/g,"='");		// replace charactercombination =" with ='
		myLine = myLine.replace(/">/g,"'>");		// replace charactercombination "> with '>
		myLine = myLine.replace(/\\"/g,"\'");		// replace double quote with a single quote
		return myLine;
	}

	function toJSON(data) {
		// split on tr and td
		// First row contains head-information
		myJSON = {}
		myArray = [];
		try {
			var myRowArray = $(data).find('tr');
			var myRememberCol0;             // remember content of column 0 because it does not always have a value
			var myColHeaderArray = [];      // contains header text to preserve for content keys
			var myColArray = [];			// contains content

			var myHeader = {};
			var headerId = 0;               // first part for identifying a record that consist of a header and a type
			var typeId = 0;                 // second part for identifying a record that consist of a header and a type
			var skipEmptyHeader = [];       // contains colums to skip, because the header is empty
			var headerArray = [];			// keeps track of headers for updating the id-key of a content object
			var headerList = {};            // keeps track of headers and types for updating the id-key of a content object
			$.each(myRowArray, function(rIndex, rValue) {
				var myContent = {};
				$.each($(rValue).find('td'), function(cIndex, cValue) {
					var myText = $(cValue).text();
					if ((myText == "") && (rIndex == 0)) {  // add empty header row number
						skipEmptyHeader.push(cIndex);
					}
					// start fill first column if it contains an empty values
					if (cIndex == 0) {
						if (myText.replace(/\s+/g, "") == "") {
							myText = myRememberCol0;
						}
						else {
							myRememberCol0 = myText;
						}
					}
					// start keep layout in the example fields
					if (cIndex > 1) {
						myText = $(cValue).html();
					}
					// end keep layout in the example fields
					
					// end fill first column if there are empty values

					// start set id
					if ((myText.replace(/\s+/g, "") != "") && (cIndex == 0)) {  // header; add headerList
						if (myText in headerList) { 
							var numberOfAmbiguisHeadings = headerList[myText].length;
							headerList[myText].push(numberOfAmbiguisHeadings);	// so there must be another heading which leads to updating a type by 1 (that is the push)
						}
						else {
							headerList[myText] = [0];		// first appearance of this heading
							headerArray.push(myText);		// the position in this array is the id for a heading 
						}
					}
					// reads per column, so headerList is up to date until this row and myRememberCol0 holds the last value of heading (=header)
					if ((rIndex > 0) && (cIndex == 1)) {  // type; set id
						if (myRememberCol0 in headerList) {
							headerId = $.inArray(myRememberCol0, headerArray) || 0;
							if (headerId > 0) {
								typeId = headerList[myRememberCol0].length;
							}
						}
						myContent["id"] = (headerId - 1).toString() + "_" + (typeId - 1).toString();	// offset = 0
					}
					// end set id 
					
					// start get header information
					if (rIndex == 0) {
						if ($.inArray(cIndex, skipEmptyHeader) == -1) {  // skip for empty headers
							myHeader[cIndex] = myText.replace(/\n/g, "").replace(/\s+/g, " ");
							myColHeaderArray.push(cIndex.toString());   // remember to serve as key for content value (number as text)
						}
					}
					// end get header information

					// start get content information and combine this with the previous gathered header information
					// add a content-id which has the value of 0..n for the heading and 0..n for the type, joined by a _ (e.g. 0_0, 0_1) 
					if (rIndex > 0) {
						if ($.inArray(cIndex, skipEmptyHeader) == -1) {  // skip for empty headers
							myContent[myColHeaderArray[cIndex]] = filterInput(myText);
							// doubble headings will be replaced while sorting ...
						}
					}
					// end get content information and combine this with the previous gathered header information
				});
				if (rIndex > 0) {
					if (Object.keys(myHeader).length +1 == Object.keys(myContent).length) {		// +1 = for extra id key in myContent
						myColArray.push(myContent);
					}
				}
			});
			myJSON["header"] = myHeader;
			myJSON["content"] = myColArray;
			myJSON = getSortedContentWithChangedId(myJSON);
			//console.log(JSON.stringify(myJSON));
			return myJSON;
		}
		catch(e) {
			console.log(e);
		}
	};
</script>
	
<script>
	function pad (str, max) {
	  str = str.toString();
	  return str.length < max ? pad("0" + str, max) : str;
	}
</script>
	
<script>
	function addStyle(data) {
		var layout = $(data).filter('style');		// head section requires filter instead of find
		$("#data-style").html($(layout));
	}
</script>

<script>
var jsonDummy = '\
{\
	"header": {\
		"0": "Heading",\
		"1": "Types",\
		"2": "Combines with",\
		"3": "Ranking headings",\
		"4": "Ranking types",\
		"5": "In-tekst example",\
		"6": "Reference list example",\
		"7": "Figure heading example",\
		"8": "Remark"\
	},\
	"content": [{\
		"0": "Books",\
		"1": "Paper book",\
		"2": "",\
		"3": "1",\
		"4": "1",\
		"5": "Dorf<span style=\'mso-spacerun:yes\'></span>",\
		"6": "Dorf, R. C.. <font class=\"font10\">The electrical engineering handbook</font><font class=\"font9\"><span style=\"mso-spacerun:yes\"></span>(3rd ed.). Boca Raton, FL: CRC/Taylor &amp; Francis.<span style=\"mso-spacerun:yes\"></span></font>",\
		"7": "",\
		"8": "Place information about editions, volume numbers, and page numbers in parentheses with the period after the parentheses:. or.",\
		"id": "0_0"\
	}, {\
		"0": "Books",\
		"1": "Electronic book with doi",\
		"2": "",\
		"3": "1",\
		"4": "3",\
		"5": "Ardia<span style=\"mso-spacerun:yes\"> </span>(2008, p. xx)<span style=\"mso-spacerun:yes\"></span>",\
		"6": "Ardia, D.. <font class=\"font6\">Financial risk management with Bayesian estimation of GARCH models: theory and applications</font><font class=\"font0\">. doi:10.1007/978-3-540-78657-3</font>",\
		"7": "",\
		"8": "For books or chapters available online, the electronic retrieval statement takes the place of publisher location and name.",\
		"id": "0_1"\
	}, {\
		"0": "Books",\
		"1": "Electronic book with link",\
		"2": "",\
		"3": "1",\
		"4": "4",\
		"5": "Edwards<span style=\"mso-spacerun:yes\"></span>",\
		"6": "Edwards, P. N.. <font class=\"font6\">How to Read a Book</font><font class=\"font0\"><span style=\"mso-spacerun:yes\"></span>(v 5.0). Retrieved from http://pne.people.si.umich.edu/PDF/howtoread.pdf</font>",\
		"7": "",\
		"8": "For books or chapters available online, the electronic retrieval statement takes the place of publisher location and name.",\
		"id": "0_2"\
	}, {\
		"0": "Books",\
		"1": "Edited book",\
		"2": "",\
		"3": "1",\
		"4": "2",\
		"5": "The Encyclopedia of aerospace engineering<span style=\"mso-spacerun:yes\"></span>",\
		"6": "Blockley, R., &amp; Shyy, W... <font class=\"font6\">Encyclopedia of aerospace engineering</font><font class=\"font0\">.. Milton Keynes, England: Wiley.</font>",\
		"7": "",\
		"8": "For works with a large editorial board, use the name of the lead editor, followed by et al.",\
		"id": "0_3"\
	}, {\
		"0": "Books",\
		"1": "Book chapter",\
		"2": "",\
		"3": "1",\
		"4": "5",\
		"5": "Gibson<span style=\"mso-spacerun:yes\"></span>",\
		"6": "Gibson, C. C..<font class=\"font10\"> </font><font class=\"font9\">Impact of the larger social context on the distance learner</font><font class=\"font10\">.</font><font class=\"font9\"> In S. Allsop </font><font class=\"font0\">(Ed.),</font><font class=\"font9\"> </font><font class=\"font10\">International Council for</font><font class=\"font6\"> Distance</font><font class=\"font10\"> Education: One world many voices: Quality in open</font><font class=\"font6\"> and</font><font class=\"font10\"> </font><font class=\"font6\">distance learning</font><font class=\"font0\"><span style=\"mso-spacerun:yes\"></span>(pp. 279-282). Chicago, IL: Milton Keynes.</font>",\
		"7": "",\
		"8": "",\
		"id": "0_4"\
	}, {\
		"0": "Books",\
		"1": "Brochure",\
		"2": "",\
		"3": "1",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "0_5"\
	}, {\
		"0": "Books",\
		"1": "Thesis",\
		"2": "",\
		"3": "1",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "0_6"\
	}, {\
		"0": "Books",\
		"1": "Lecture note",\
		"2": "",\
		"3": "1",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "0_7"\
	}, {\
		"0": "Authors",\
		"1": "Single author",\
		"2": "Books, Articles & Papers",\
		"3": "7",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "1_0"\
	}, {\
		"0": "Books",\
		"1": "Single author",\
		"2": "",\
		"3": "1",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "0_8"\
	}, {\
		"0": "Articles & Papers",\
		"1": "Single author",\
		"2": "",\
		"3": "2",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "2_0"\
	}, {\
		"0": "Authors",\
		"1": "Organisation/Institution",\
		"2": "Reports",\
		"3": "7",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "1_1"\
	}, {\
		"0": "Books",\
		"1": "Organisation/Institution",\
		"2": "",\
		"3": "1",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "0_9"\
	}, {\
		"0": "Reports",\
		"1": "Organisation/Institution",\
		"2": "",\
		"3": "3",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "3_0"\
	}, {\
		"0": "Authors",\
		"1": "Two authors",\
		"2": "Books, Articles & Papers",\
		"3": "7",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "1_2"\
	}, {\
		"0": "Books",\
		"1": "Two authors",\
		"2": "",\
		"3": "1",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "0_10"\
	}, {\
		"0": "Articles & Papers",\
		"1": "Two authors",\
		"2": "",\
		"3": "2",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "2_1"\
	}, {\
		"0": "Authors",\
		"1": "Three till five authors",\
		"2": "Books, Articles & Papers",\
		"3": "7",\
		"4": "",\
		"5": "Anderson, Sweeney and Williams<span style=\"mso-spacerun:yes\"></span>",\
		"6": "Anderson, D. R., Sweeney, D. J., &amp; Williams, T. A.. <font class=\"font6\">Quantitative methods for business</font><font class=\"font0\">. Mason, OH: Thomson.</font>",\
		"7": "",\
		"8": "",\
		"id": "1_3"\
	}, {\
		"0": "Books",\
		"1": "Three till five authors",\
		"2": "",\
		"3": "1",\
		"4": "",\
		"5": "Anderson, Sweeney and Williams<span style=\"mso-spacerun:yes\"></span>",\
		"6": "Anderson, D. R., Sweeney, D. J., &amp; Williams, T. A.. <font class=\"font6\">Quantitative methods for business</font><font class=\"font0\">. Mason, OH: Thomson.</font>",\
		"7": "",\
		"8": "",\
		"id": "0_11"\
	}, {\
		"0": "Articles & Papers",\
		"1": "Three till five authors",\
		"2": "",\
		"3": "2",\
		"4": "",\
		"5": "Anderson, Sweeney and Williams <span style=\"mso-spacerun:yes\"></span>",\
		"6": "Anderson, D. R., Sweeney, D. J., &amp; Williams, T. A.. <font class=\"font15\">Quantitative methods for business</font><font class=\"font7\">. Mason, OH: Thomson.</font>",\
		"7": "",\
		"8": "",\
		"id": "2_2"\
	}, {\
		"0": "Authors",\
		"1": "Six or more authors",\
		"2": "Books, Articles & Papers",\
		"3": "7",\
		"4": "",\
		"5": "Brown et al.<span style=\"mso-spacerun:yes\"></span>",\
		"6": "Brown, D., Harper, H., Frei, M., Ingham, M., Otter, G. Raskin, J., � Delay, A. . <font class=\"font6\">Basic writing skills</font><font class=\"font0\">. Toronto, Canada: McGraw-Hill.</font>",\
		"7": "",\
		"8": "",\
		"id": "1_4"\
	}, {\
		"0": "Books",\
		"1": "Six or more authors",\
		"2": "",\
		"3": "1",\
		"4": "",\
		"5": "Brown et al. <span style=\"mso-spacerun:yes\"></span>",\
		"6": "Brown, D., Harper, H., Frei, M., Ingham, M., Otter, G. Raskin, J., � Delay, A. . <font class=\"font6\">Basic writing skills</font><font class=\"font0\">. Toronto, Canada: McGraw-Hill.</font>",\
		"7": "",\
		"8": "",\
		"id": "0_12"\
	}, {\
		"0": "Articles & Papers",\
		"1": "Six or more authors",\
		"2": "",\
		"3": "2",\
		"4": "",\
		"5": "Brown et al. <span style=\"mso-spacerun:yes\"></span>",\
		"6": "Brown, D., Harper, H., Frei, M., Ingham, M., Otter, G. Raskin, J., � Delay, A. . <font class=\"font6\">Basic writing skills</font><font class=\"font0\">. Toronto, Canada: McGraw-Hill.</font>",\
		"7": "",\
		"8": "",\
		"id": "2_3"\
	}, {\
		"0": "Authors",\
		"1": "Authors with the same last name",\
		"2": "Books, Articles &; Papers",\
		"3": "7",\
		"4": "",\
		"5": "(P. M. Anderson, 2003, p. xx)<br> <br> ",\
		"6": "Anderson, J. B.. <font class=\"font6\">Digital transmission engineering</font><font class=\"font0\">. Piscataway, NJ: IEEE Press.<br> Anderson, P. M.. </font><font class=\"font6\">Analysis of faulted power systems</font><font class=\"font0\">. Piscataway, NJ: IEEE Press.<span style=\"mso-spacerun:yes\"> </span><br> </font>",\
		"7": "",\
		"8": "",\
		"id": "1_5"\
	}, {\
		"0": "Books",\
		"1": "Authors with the same last name",\
		"2": "",\
		"3": "1",\
		"4": "",\
		"5": "(P. M. Anderson, 2003, p. xx)<br> <br> ",\
		"6": "Anderson, J. B.. <font class=\"font6\">Digital transmission engineering</font><font class=\"font0\">. Piscataway, NJ: IEEE Press.<br> Anderson, P. M.. </font><font class=\"font6\">Analysis of faulted power systems</font><font class=\"font0\">. Piscataway, NJ: IEEE Press.<span style=\"mso-spacerun:yes\"> </span><br> </font>",\
		"7": "",\
		"8": "",\
		"id": "0_13"\
	}, {\
		"0": "Articles & Papers",\
		"1": "Authors with the same last name",\
		"2": "",\
		"3": "2",\
		"4": "",\
		"5": "(P. M. Anderson, 2003, p. xx)<br> <br> ",\
		"6": "Anderson, J. B.. <font class=\"font15\">Digital transmission engineering</font><font class=\"font7\">. Piscataway, NJ: IEEE Press.<br> Anderson, P. M.. </font><font class=\"font15\">Analysis of faulted power systems</font><font class=\"font7\">. Piscataway, NJ: IEEE Press.<span style=\"mso-spacerun:yes\"> </span><br> </font>",\
		"7": "",\
		"8": "",\
		"id": "2_4"\
	}, {\
		"0": "Authors",\
		"1": "Multiple works by the same author",\
		"2": "Books, Articles & Papers",\
		"3": "7",\
		"4": "",\
		"5": "(Smith, 2005, p. xx; 2007, p. yy)<span style=\"mso-spacerun:yes\"></span>",\
		"6": "Smith, P.. <font class=\"font6\">Piping Materials Guide</font><font class=\"font0\">. Oxford, England: Elsevier.<br> Smith, P.. </font><font class=\"font6\">Process piping design handbook: fundamentals of piping design</font><font class=\"font0\">. Houston, TX: Gulf.<br> </font>",\
		"7": "",\
		"8": "",\
		"id": "1_6"\
	}, {\
		"0": "Books",\
		"1": "Multiple works by the same author",\
		"2": "",\
		"3": "1",\
		"4": "",\
		"5": "(Smith, 2005, p. xx; 2007, p. yy)<span style=\"mso-spacerun:yes\"></span>",\
		"6": "Smith, P.. <font class=\"font6\">Piping Materials Guide</font><font class=\"font0\">. Oxford, England: Elsevier.<br> Smith, P.. </font><font class=\"font6\">Process piping design handbook: fundamentals of piping design</font><font class=\"font0\">. Houston, TX: Gulf.<br> </font>",\
		"7": "",\
		"8": "",\
		"id": "0_14"\
	}, {\
		"0": "Articles & Papers",\
		"1": "Multiple works by the same author",\
		"2": "",\
		"3": "2",\
		"4": "",\
		"5": "(Smith, 2005, p. xx; 2007, p. yy)<span style=\"mso-spacerun:yes\"></span>",\
		"6": "Smith, P.. <font class=\"font15\">Piping Materials Guide</font><font class=\"font7\">. Oxford, England: Elsevier.<br> Smith, P.. </font><font class=\"font15\">Process piping design handbook: fundamentals of piping design</font><font class=\"font7\">. Houston, TX: Gulf.<br> </font>",\
		"7": "",\
		"8": "",\
		"id": "2_5"\
	}, {\
		"0": "Authors",\
		"1": "Multiple works by the same author in the same year",\
		"2": "Books, Articles & Papers",\
		"3": "7",\
		"4": "",\
		"5": "(Napier, 1993a, p. xx; 1993b, p. yy) �",\
		"6": "Napier, A..<font class=\"font6\"> Fatal storm</font><font class=\"font0\">. Sydney, Australia: Allen &amp; Unwin. <br> Napier, A.. </font><font class=\"font6\">Survival at sea</font><font class=\"font0\">. Sydney, Australia: Allen &amp; Unwin.<br> </font>",\
		"7": "",\
		"8": "",\
		"id": "1_7"\
	}, {\
		"0": "Books",\
		"1": "Multiple works by the same author in the same year",\
		"2": "",\
		"3": "1",\
		"4": "",\
		"5": "(Napier, 1993a, p. xx; 1993b, p. yy) �",\
		"6": "Napier, A..<font class=\"font6\"> Fatal storm</font><font class=\"font0\">. Sydney, Australia: Allen &amp; Unwin. <br> Napier, A.. </font><font class=\"font6\">Survival at sea</font><font class=\"font0\">. Sydney, Australia: Allen &amp; Unwin.<br> </font>",\
		"7": "",\
		"8": "",\
		"id": "0_15"\
	}, {\
		"0": "Articles & Papers",\
		"1": "Multiple works by the same author in the same year",\
		"2": "",\
		"3": "",\
		"4": "",\
		"5": "(Napier, 1993a, p. xx; 1993b, p. yy) �",\
		"6": "Napier, A..<font class=\"font15\"> Fatal storm</font><font class=\"font7\">. Sydney, Australia: Allen &amp; Unwin. <br> Napier, A.. </font><font class=\"font15\">Survival at sea</font><font class=\"font7\">. Sydney, Australia: Allen &amp; Unwin.<br> </font>",\
		"7": "",\
		"8": "",\
		"id": "2_6"\
	}, {\
		"0": "Articles & Papers",\
		"1": "Journal article",\
		"2": "",\
		"3": "2",\
		"4": "",\
		"5": "(Cutler, 2011)",\
		"6": "Cutler, A. D.. High-Frequency Pulsed Combustion Actuator Experiments. <font class=\"font6\">AIAA Journal</font><font class=\"font0\">, </font><font class=\"font6\">49</font><font class=\"font0\">(9), 1943-1950.</font>",\
		"7": "",\
		"8": "",\
		"id": "2_7"\
	}, {\
		"0": "Articles & Papers",\
		"1": "Journal article with DOI",\
		"2": "",\
		"3": "2",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "2_8"\
	}, {\
		"0": "Articles & Papers",\
		"1": "Newspaper article",\
		"2": "",\
		"3": "2",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "2_9"\
	}, {\
		"0": "Articles & Papers",\
		"1": "Online newspaper article",\
		"2": "",\
		"3": "2",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "2_10"\
	}, {\
		"0": "Reports",\
		"1": "Printed report",\
		"2": "",\
		"3": "3",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "3_1"\
	}, {\
		"0": "Reports",\
		"1": "Online report",\
		"2": "",\
		"3": "3",\
		"4": "",\
		"5": "It is stated by Van der Wel and Bergen �",\
		"6": "Van der Wel, N., &amp; Bergen, V. H. S.. <font class=\"font6\">Plattelandsvernieuwing en cultuur: interactieve planontwikkeling </font><font class=\"font0\">(NRLO-rapport nr. 2000/8). Retrieved from Innovatie Agro &amp; Natuur website: http://publications.tno.nl/publication/34614835/QuPGHi/NRLO-2000-08.pdf</font>",\
		"7": "",\
		"8": "",\
		"id": "3_2"\
	}, {\
		"0": "On the internet/Social media",\
		"1": "Page on the internet",\
		"2": "",\
		"3": "4",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "5_0"\
	}, {\
		"0": "On the internet/Social media",\
		"1": "Company on the internet",\
		"2": "",\
		"3": "4",\
		"4": "",\
		"5": "On the website of Boei �.",\
		"6": "Boei.. Project graansilo. Retrieved May 23, 2017 from http://www.boei.nl/projecten/graansilo-wehl",\
		"7": "",\
		"8": "",\
		"id": "5_1"\
	}, {\
		"0": "On the internet/Social media",\
		"1": "Entry online encyclopedia",\
		"2": "",\
		"3": "4",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "5_2"\
	}, {\
		"0": "On the internet/Social media",\
		"1": "Podcast",\
		"2": "",\
		"3": "4",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "5_3"\
	}, {\
		"0": "On the internet/Social media",\
		"1": "YouTube",\
		"2": "",\
		"3": "4",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "5_4"\
	}, {\
		"0": "On the internet/Social media",\
		"1": "Web log post/comment",\
		"2": "",\
		"3": "4",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "5_5"\
	}, {\
		"0": "Patents",\
		"1": "Patents",\
		"2": "",\
		"3": "5",\
		"4": "",\
		"5": "..� the invention by Bellusci and Janssen is an example of .�.",\
		"6": "Bellusci, G., &amp; Janssen, G. J. M.. <font class=\"font6\">WO 2010/131966 A1</font><font class=\"font0\">. Geneva, Switzerland: World Intellectual Property Organization.</font>",\
		"7": "",\
		"8": "",\
		"id": "7_0"\
	}, {\
		"0": "Standards",\
		"1": "Standards",\
		"2": "",\
		"3": "6",\
		"4": "",\
		"5": "�.. In standard NEN 6578:2011 �..",\
		"6": "Nederlands Normalisatie Instituut.. <font class=\"font6\">Water - Potentiometrische bepaling van het totale gehalte aan totaal fluoride NEN 6578:2011</font><font class=\"font0\">. Delft, The Netherlands: Author.</font>",\
		"7": "",\
		"8": "",\
		"id": "8_0"\
	}, {\
		"0": "Illustrations & Maps",\
		"1": "Image in a book",\
		"2": "Books",\
		"3": "8",\
		"4": "",\
		"5": "The image �Local scour at piers as illustrated by model experiment and pir failure� is �",\
		"6": "Transportation Association of Canada.. <font class=\"font6\">Guide to bridge hydraulics</font><font class=\"font0\"><span style=\"mso-spacerun:yes\"></span>(2nd ed.). London, England: Telford.</font>",\
		"7": "Figure X. Local scour at piers as illustrated by model experiment and pir failure. From <font class=\"font6\">Guide to bridge hydraulics </font><font class=\"font0\">(2nd ed., p. 68), by Transportation Association of Canada, 2004, London, England: Telford. Copyright 2004 by Transportation Association of Canada.</font>",\
		"8": "",\
		"id": "9_0"\
	}, {\
		"0": "Books",\
		"1": "Image in a book",\
		"2": "",\
		"3": "1",\
		"4": "",\
		"5": "The image �Local scour at piers as illustrated by model experiment and pir failure� is �",\
		"6": "Transportation Association of Canada.. <font class=\"font6\">Guide to bridge hydraulics</font><font class=\"font0\"><span style=\"mso-spacerun:yes\"></span>(2nd ed.). London, England: Telford.</font>",\
		"7": "Figure X. Local scour at piers as illustrated by model experiment and pir failure. From <font class=\"font6\">Guide to bridge hydraulics </font><font class=\"font0\">(2nd ed., p. 68), by Transportation Association of Canada, 2004, London, England: Telford. Copyright 2004 by Transportation Association of Canada.</font>",\
		"8": "",\
		"id": "0_16"\
	}, {\
		"0": "Illustrations & Maps",\
		"1": "Image on a website",\
		"2": "On the internet/Social media",\
		"3": "8",\
		"4": "",\
		"5": "As shown in figure 7, Houston is one of the cities In the USA with a light rail system�",\
		"6": "Haase, M.. Light rail Houston [Photograph]. Retrieved from https://commons.wikimedia.org/wiki/File:Light_Rail_Houston.jpg",\
		"7": "Figure X: Light rail Houston. From �<font class=\"font6\">Wikimedia Commons,</font><font class=\"font0\">� by M. Haase, 2006 . Licensed under CC BY 2.5</font>",\
		"8": "",\
		"id": "9_1"\
	}, {\
		"0": "On the internet/Social media",\
		"1": "Image on a website",\
		"2": "",\
		"3": "4",\
		"4": "",\
		"5": "As shown in figure 7, Houston is one of the cities In the USA with a light rail system�",\
		"6": "Haase, M.. Light rail Houston [Photograph]. Retrieved from https://commons.wikimedia.org/wiki/File:Light_Rail_Houston.jpg",\
		"7": "Figure X: Light rail Houston. From �<font class=\"font6\">Wikimedia Commons,</font><font class=\"font0\">� by M. Haase, 2006 . Licensed under CC BY 2.5</font>",\
		"8": "",\
		"id": "10_0"\
	}, {\
		"0": "Illustrations & Maps",\
		"1": "Online maps",\
		"2": "",\
		"3": "8",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "9_2"\
	}, {\
		"0": "Secondary sources",\
		"1": "Book",\
		"2": "Books",\
		"3": "9",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "11_0"\
	}, {\
		"0": "Books",\
		"1": "Secondary sources",\
		"2": "",\
		"3": "1",\
		"4": "",\
		"5": "",\
		"6": "",\
		"7": "",\
		"8": "",\
		"id": "0_18"\
	}, {\
		"0": "Unpublished work",\
		"1": "Paper book",\
		"2": "Books",\
		"3": "10",\
		"4": "",\
		"5": "Blackwell and Conrod",\
		"6": "Blackwell, E., &amp; Conrod, P. J.. <font class=\"font6\">A five-dimesional measure of drinking </font><font class=\"font0\">motives. Unpublished manuscript, Department of Psychology, University of British Colombia, Vancouver, Canada.</font>",\
		"7": "",\
		"8": "",\
		"id": "12_0"\
	}, {\
		"0": "Books",\
		"1": "Paper book",\
		"2": "",\
		"3": "1",\
		"4": "",\
		"5": "Blackwell and Conrod",\
		"6": "Blackwell, E., &amp; Conrod, P. J.. <font class=\"font6\">A five-dimesional measure of drinking </font><font class=\"font0\">motives. Unpublished manuscript, Department of Psychology, University of British Colombia, Vancouver, Canada.</font>",\
		"7": "",\
		"8": "",\
		"id": "0_19"\
	}, {\
		"0": "Unpublished work",\
		"1": "Situation sketch",\
		"2": "",\
		"3": "10",\
		"4": "",\
		"5": "Based on Jansen�.",\
		"6": "Jansen, H. H.. <font class=\"font6\">Stationsgebied Rotterdam</font><font class=\"font0\"><span style=\"mso-spacerun:yes\"></span>[Situatieschets]. Unpublished, Department of Architecture, University of Technology, Delft, The Netherlands.</font>",\
		"7": "",\
		"8": "",\
		"id": "12_1"\
	}, {\
		"0": "Illustrations & Maps",\
		"1": "Situation sketch",\
		"2": "",\
		"3": "8",\
		"4": "",\
		"5": "Based on Jansen �.",\
		"6": "Jansen, H. H. . Stationsgebied Rotterdam [Situatieschets]. Unpublished, Department of Architecture, University of Technology, Delft, The Netherlands.",\
		"7": "",\
		"8": "",\
		"id": "13_0"\
	}]\
}';
</script>

<script>
    $(document).ready(function() {
		referenceHeight = $('#reference-list-example').height();	// see global, see wrapReferenceExample

    // The event listener for the file upload
    document.getElementById('txtFileUpload').addEventListener('change', upload, false);

    // Method that checks that the browser supports the HTML5 File API
    function browserSupportFileUpload() {
        var isCompatible = false;
        if (window.File && window.FileReader && window.FileList && window.Blob) {
        isCompatible = true;
        }
        return isCompatible;
    }

    // Method that reads and processes the selected file
    function upload(evt) {
		if (!browserSupportFileUpload()) {
        	alert('The File APIs are not fully supported in this browser!');
        } 
		else {
           	var data = null;
           	var file = evt.target.files[0] || testFile;
           	var reader = new FileReader();
           	reader.readAsText(file);
           	reader.onload = function(event) {
  				try {
                   	data = event.target.result;
					apaContent = toJSON(data);
					addStyle(data);
					showHeadingOptions(apaContent);
					showTypeOptions(apaContent);
					showCombinesWith(apaContent);
					showExamples(apaContent);
					$('#select-heading').focus();
				}
				catch(err) {
					console.log(err);
					alert('Could not read file with separators , and ; (comma and semicolon). Use only one of these in your inputfile. Please change the separator character and try again.')
				}
			
               	if (data && data.length > 0) {
                 		//alert('Imported -' + data.length + '- rows successfully!');
			    	// 1 toegevoegde regel: createForm(data);
			    	//createForm(data);
			  	  startEvents();   // opnieuw, omdat de html is aangepast
               	} else {
                   	alert('No data to import!');
               	}
           	};
           	reader.onerror = function() {
               	alert('Unable to read ' + file.fileName);
           	};
        }
    }
	
	
	// start get dummy file for testing purposes
	
	var fileContent = "\
<html>\
\
<head>\
<meta name=Title\
content='Eisen voor een nieuwe APA tabel. Uitgewerkte headings en types'>\
<meta http-equiv=Content-Type content='text/html; charset=macintosh'>\
<meta name=ProgId content=Excel.Sheet>\
<meta name=Generator content='Microsoft Excel 14'>\
<link rel=File-List href='try_source_files/filelist.xml'>\
<title>Eisen voor een nieuwe APA tabel. Uitgewerkte headings en types</title>\
<style>\
<!--table\
	{mso-displayed-decimal-separator:'\,';\
	mso-displayed-thousand-separator:'\.';}\
@page\
	{margin:.75in .7in .75in .7in;\
	mso-header-margin:.3in;\
	mso-footer-margin:.3in;\
	mso-page-orientation:landscape;}\
.font0\
	{color:black;\
	font-size:11.0pt;\
	font-weight:400;\
	font-style:normal;\
	text-decoration:none;\
	font-family:Calibri, sans-serif;\
	mso-font-charset:0;}\
.font6\
	{color:black;\
	font-size:11.0pt;\
	font-weight:400;\
	font-style:italic;\
	text-decoration:none;\
	font-family:Calibri, sans-serif;\
	mso-font-charset:0;}\
.font8\
	{color:black;\
	font-size:11.0pt;\
	font-weight:400;\
	font-style:normal;\
	text-decoration:none;\
	font-family:Calibri, sans-serif;\
	mso-font-charset:0;}\
.font9\
	{color:black;\
	font-size:11.0pt;\
	font-weight:400;\
	font-style:italic;\
	text-decoration:none;\
	font-family:Calibri, sans-serif;\
	mso-font-charset:0;}\
.style0\
	{mso-number-format:General;\
	text-align:general;\
	vertical-align:bottom;\
	white-space:nowrap;\
	mso-rotate:0;\
	mso-background-source:auto;\
	mso-pattern:auto;\
	color:black;\
	font-size:11.0pt;\
	font-weight:400;\
	font-style:normal;\
	text-decoration:none;\
	font-family:Calibri, sans-serif;\
	mso-font-charset:0;\
	border:none;\
	mso-protection:locked visible;\
	mso-style-name:Normal;\
	mso-style-id:0;}\
td\
	{mso-style-parent:style0;\
	padding-top:1px;\
	padding-right:1px;\
	padding-left:1px;\
	mso-ignore:padding;\
	color:black;\
	font-size:11.0pt;\
	font-weight:400;\
	font-style:normal;\
	text-decoration:none;\
	font-family:Calibri, sans-serif;\
	mso-font-charset:0;\
	mso-number-format:General;\
	text-align:general;\
	vertical-align:bottom;\
	border:none;\
	mso-background-source:auto;\
	mso-pattern:auto;\
	mso-protection:locked visible;\
	white-space:nowrap;\
	mso-rotate:0;}\
.xl65\
	{mso-style-parent:style0;\
	font-weight:700;}\
.xl66\
	{mso-style-parent:style0;\
	font-weight:700;\
	border:.5pt solid windowtext;}\
.xl67\
	{mso-style-parent:style0;\
	border:.5pt solid windowtext;}\
.xl68\
	{mso-style-parent:style0;\
	border:.5pt solid windowtext;\
	white-space:normal;}\
.xl69\
	{mso-style-parent:style0;\
	font-size:12.0pt;\
	font-weight:700;\
	border:.5pt solid windowtext;}\
.xl70\
	{mso-style-parent:style0;\
	font-size:12.0pt;\
	font-weight:700;\
	border:.5pt solid windowtext;\
	white-space:normal;}\
.xl71\
	{mso-style-parent:style0;\
	vertical-align:top;\
	border:.5pt solid windowtext;}\
.xl72\
	{mso-style-parent:style0;\
	color:red;\
	font-family:Symbol, serif;\
	mso-font-charset:2;\
	text-align:left;\
	vertical-align:middle;\
	padding-left:60px;\
	mso-char-indent-count:5;}\
.xl73\
	{mso-style-parent:style0;\
	text-align:left;\
	vertical-align:top;\
	border:.5pt solid windowtext;}\
.xl74\
	{mso-style-parent:style0;\
	font-size:12.0pt;\
	font-weight:700;\
	white-space:normal;}\
.xl75\
	{mso-style-parent:style0;\
	color:black;\
	text-align:left;\
	vertical-align:top;\
	border:.5pt solid windowtext;\
	white-space:normal;\
	padding-left:12px;\
	mso-char-indent-count:1;}\
.xl76\
	{mso-style-parent:style0;\
	vertical-align:top;\
	border:.5pt solid windowtext;\
	white-space:normal;}\
.xl77\
	{mso-style-parent:style0;\
	text-align:left;\
	vertical-align:top;\
	border:.5pt solid windowtext;\
	white-space:normal;}\
.xl78\
	{mso-style-parent:style0;\
	color:black;\
	vertical-align:top;\
	border:.5pt solid windowtext;}\
.xl79\
	{mso-style-parent:style0;\
	color:black;\
	text-align:left;\
	vertical-align:top;\
	border:.5pt solid windowtext;\
	white-space:normal;}\
.xl80\
	{mso-style-parent:style0;\
	font-weight:700;\
	vertical-align:top;\
	border:.5pt solid windowtext;}\
.xl81\
	{mso-style-parent:style0;\
	font-weight:700;\
	border:.5pt solid windowtext;\
	white-space:normal;}\
.xl82\
	{mso-style-parent:style0;\
	vertical-align:top;\
	white-space:normal;}\
.xl83\
	{mso-style-parent:style0;\
	font-weight:700;\
	vertical-align:top;\
	border:.5pt solid windowtext;\
	white-space:normal;}\
.xl84\
	{mso-style-parent:style0;\
	font-weight:700;\
	vertical-align:top;\
	border-top:none;\
	border-right:.5pt solid windowtext;\
	border-bottom:none;\
	border-left:.5pt solid windowtext;}\
.xl85\
	{mso-style-parent:style0;\
	color:windowtext;\
	font-weight:700;\
	vertical-align:top;\
	border:.5pt solid windowtext;}\
.xl86\
	{mso-style-parent:style0;\
	color:#00B050;}\
.xl87\
	{mso-style-parent:style0;\
	color:black;\
	vertical-align:top;\
	border:.5pt solid windowtext;\
	white-space:normal;}\
.xl88\
	{mso-style-parent:style0;\
	font-weight:700;\
	border-top:.5pt solid windowtext;\
	border-right:.5pt solid windowtext;\
	border-bottom:.5pt solid windowtext;\
	border-left:none;}\
.xl89\
	{mso-style-parent:style0;\
	border-top:.5pt solid windowtext;\
	border-right:.5pt solid windowtext;\
	border-bottom:.5pt solid windowtext;\
	border-left:none;}\
.xl90\
	{mso-style-parent:style0;\
	border-top:none;\
	border-right:.5pt solid windowtext;\
	border-bottom:none;\
	border-left:.5pt solid windowtext;}\
.xl91\
	{mso-style-parent:style0;\
	border-top:none;\
	border-right:.5pt solid windowtext;\
	border-bottom:.5pt solid windowtext;\
	border-left:.5pt solid windowtext;}\
.xl92\
	{mso-style-parent:style0;\
	border-top:none;\
	border-right:.5pt solid windowtext;\
	border-bottom:.5pt solid windowtext;\
	border-left:none;}\
.xl93\
	{mso-style-parent:style0;\
	border-top:.5pt solid windowtext;\
	border-right:.5pt solid windowtext;\
	border-bottom:none;\
	border-left:.5pt solid windowtext;}\
.xl94\
	{mso-style-parent:style0;\
	vertical-align:top;\
	border-top:.5pt solid windowtext;\
	border-right:.5pt solid windowtext;\
	border-bottom:.5pt solid windowtext;\
	border-left:none;\
	white-space:normal;}\
.xl95\
	{mso-style-parent:style0;\
	color:black;\
	vertical-align:top;\
	border-top:1.0pt solid windowtext;\
	border-right:1.0pt solid windowtext;\
	border-bottom:1.0pt solid windowtext;\
	border-left:none;\
	white-space:normal;}\
.xl96\
	{mso-style-parent:style0;\
	color:black;\
	text-align:right;\
	border:.5pt solid windowtext;\
	white-space:normal;\
	padding-right:12px;\
	mso-char-indent-count:1;}\
.xl97\
	{mso-style-parent:style0;\
	font-size:12.0pt;\
	font-weight:700;}\
.xl98\
	{mso-style-parent:style0;\
	vertical-align:top;\
	border-top:none;\
	border-right:.5pt solid windowtext;\
	border-bottom:.5pt solid windowtext;\
	border-left:.5pt solid windowtext;}\
.xl99\
	{mso-style-parent:style0;\
	vertical-align:top;\
	border-top:none;\
	border-right:.5pt solid windowtext;\
	border-bottom:.5pt solid windowtext;\
	border-left:.5pt solid windowtext;\
	white-space:normal;}\
.xl100\
	{mso-style-parent:style0;\
	vertical-align:top;\
	border-top:none;\
	border-right:.5pt solid windowtext;\
	border-bottom:none;\
	border-left:.5pt solid windowtext;\
	white-space:normal;}\
.xl101\
	{mso-style-parent:style0;\
	color:windowtext;\
	font-weight:700;\
	border:.5pt solid windowtext;}\
.xl102\
	{mso-style-parent:style0;\
	color:windowtext;\
	font-family:Calibri;\
	mso-generic-font-family:auto;\
	mso-font-charset:0;\
	border:.5pt solid windowtext;}\
.xl103\
	{mso-style-parent:style0;\
	color:windowtext;\
	font-family:Calibri;\
	mso-generic-font-family:auto;\
	mso-font-charset:0;\
	border-top:.5pt solid windowtext;\
	border-right:.5pt solid windowtext;\
	border-bottom:.5pt solid windowtext;\
	border-left:none;}\
.xl104\
	{mso-style-parent:style0;\
	color:windowtext;\
	font-family:Calibri;\
	mso-generic-font-family:auto;\
	mso-font-charset:0;\
	border:.5pt solid windowtext;\
	white-space:normal;}\
.xl105\
	{mso-style-parent:style0;\
	color:windowtext;\
	font-family:Calibri;\
	mso-generic-font-family:auto;\
	mso-font-charset:0;}\
-->\
</style>\
</head>\
\
<body link=blue vlink=purple>\
\
<table border=0 cellpadding=0 cellspacing=0 width=1903 style='border-collapse:\
 collapse;table-layout:fixed;width:1903pt'>\
 <col width=199 style='mso-width-source:userset;mso-width-alt:8490;width:199pt'>\
 <col width=143 style='mso-width-source:userset;mso-width-alt:6101;width:143pt'>\
 <col width=340 style='mso-width-source:userset;mso-width-alt:14506;width:340pt'>\
 <col width=213 style='mso-width-source:userset;mso-width-alt:9088;width:213pt'>\
 <col width=148 style='mso-width-source:userset;mso-width-alt:6314;width:148pt'>\
 <col width=147 style='mso-width-source:userset;mso-width-alt:6272;width:147pt'>\
 <col width=250 span=2 style='mso-width-source:userset;mso-width-alt:10666;\
 width:250pt'>\
 <col width=213 style='mso-width-source:userset;mso-width-alt:9088;width:213pt'>\
 <tr class=xl65 height=15 style='height:15.0pt'>\
  <td height=15 class=xl69 width=199 style='height:15.0pt;width:199pt'>Heading</td>\
  <td class=xl69 width=143 style='border-left:none;width:143pt'>Types</td>\
  <td class=xl97 width=340 style='width:340pt'>Combines with</td>\
  <td class=xl74 width=213 style='width:213pt'>Ranking headings</td>\
  <td class=xl65 width=148 style='width:148pt'>Ranking types</td>\
  <td class=xl69 width=147 style='width:147pt'>In-tekst example</td>\
  <td class=xl70 width=250 style='border-left:none;width:250pt'>Reference list\
  example</td>\
  <td class=xl70 width=250 style='border-left:none;width:250pt'>Figure heading\
  example</td>\
  <td class=xl66 width=213 style='border-left:none;width:213pt'>Remark</td>\
 </tr>\
 <tr class=xl65 height=56 style='height:56.0pt'>\
  <td height=56 class=xl80 style='height:56.0pt;border-top:none'>Books</td>\
  <td class=xl73 style='border-top:none;border-left:none'>Paper book</td>\
  <td class=xl73 style='border-left:none'>Authors, Illustrations &amp; Maps,\
  Secondary sources,Unpublished work</td>\
  <td class=xl96 width=213 style='border-left:none;width:213pt'>1</td>\
  <td class=xl88 align=right>1</td>\
  <td class=xl71 style='border-top:none;border-left:none'>Dorf (2006, p.\
  51)<span style='mso-spacerun:yes'>&nbsp;</span></td>\
  <td class=xl75 width=250 style='border-top:none;border-left:none;width:250pt'>Dorf,\
  R. C. (2006). <font class='font9'>The electrical engineering     handbook</font><font\
  class='font8'><span style='mso-spacerun:yes'>&nbsp;</span>(3rd ed.). Boca\
  Raton, FL: CRC/Taylor &amp; Francis.<span\
  style='mso-spacerun:yes'>&nbsp;</span></font></td>\
  <td class=xl75 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl68 width=213 style='border-top:none;border-left:none;width:213pt'>Place\
  information about editions, volume numbers, and page numbers in parentheses\
  with the period after the parentheses: (Rev. ed.). or (Vol. xx, pp. xxx-xxx).</td>\
 </tr>\
 <tr height=42 style='height:42.0pt'>\
  <td height=42 class=xl80 style='height:42.0pt;border-top:none'>Books</td>\
  <td class=xl71 style='border-top:none;border-left:none'>Electronic book with\
  doi</td>\
  <td class=xl71 style='border-top:none;border-left:none'>Authors,\
  Illustrations &amp; Maps, Secondary sources,Unpublished work</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>1</td>\
  <td class=xl89 align=right style='border-top:none'>2</td>\
  <td class=xl78 style='border-top:none;border-left:none'>Ardia<span\
  style='mso-spacerun:yes'>&nbsp; </span>(2008, p. xx)<span\
  style='mso-spacerun:yes'>&nbsp;</span></td>\
  <td class=xl77 width=250 style='border-top:none;border-left:none;width:250pt'>Ardia,\
  D. (2008). <font class='font6'>Financial risk management with Bayesian\
  estimation of GARCH models: theory and applications</font><font class='font0'>.\
  doi:10.1007/978-3-540-78657-3</font></td>\
  <td class=xl77 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl76 width=213 style='border-top:none;border-left:none;width:213pt'>For\
  books or chapters available online, the electronic retrieval statement takes\
  the place of publisher location and name.</td>\
 </tr>\
 <tr height=42 style='height:42.0pt'>\
  <td height=42 class=xl80 style='height:42.0pt;border-top:none'>Books</td>\
  <td class=xl71 style='border-top:none;border-left:none'>Electronic book with\
  link</td>\
  <td class=xl71 style='border-top:none;border-left:none'>Authors,\
  Illustrations &amp; Maps, Secondary sources,Unpublished work</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>1</td>\
  <td class=xl89 align=right style='border-top:none'>3</td>\
  <td class=xl78 style='border-top:none;border-left:none'>Edwards (2008, p.\
  xx)<span style='mso-spacerun:yes'>&nbsp;</span></td>\
  <td class=xl77 width=250 style='border-top:none;border-left:none;width:250pt'>Edwards,\
  P. N. (2008). <font class='font6'>How to Read a Book</font><font class='font0'><span\
  style='mso-spacerun:yes'>&nbsp;</span>(v 5.0). Retrieved from\
  http://pne.people.si.umich.edu/PDF/howtoread.pdf</font></td>\
  <td class=xl77 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl77 width=213 style='border-top:none;border-left:none;width:213pt'>For\
  books or chapters available online, the electronic retrieval statement takes\
  the place of publisher location and name.</td>\
 </tr>\
 <tr height=42 style='height:42.0pt'>\
  <td height=42 class=xl80 style='height:42.0pt;border-top:none'>Books</td>\
  <td class=xl71 style='border-top:none;border-left:none'>Edited book</td>\
  <td class=xl71 style='border-top:none;border-left:none'>Authors,\
  Illustrations &amp; Maps, Secondary sources,Unpublished work</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>1</td>\
  <td class=xl89 align=right style='border-top:none'>4</td>\
  <td class=xl77 width=147 style='border-top:none;border-left:none;width:147pt'>The\
  Encyclopedia of aerospace engineering (2010, para 2.1)<span\
  style='mso-spacerun:yes'>&nbsp;</span></td>\
  <td class=xl76 width=250 style='border-top:none;border-left:none;width:250pt'>Blockley,\
  R., &amp; Shyy, W. (Eds.). (2010). <font class='font6'>Encyclopedia of\
  aerospace engineering</font><font class='font0'>. (6th ed., Vols. 1-9).\
  Milton Keynes, England: Wiley.</font></td>\
  <td class=xl76 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl77 width=213 style='border-top:none;border-left:none;width:213pt'>For\
  works with a large editorial board, use the name of the lead editor, followed\
  by et al.</td>\
 </tr>\
 <tr height=70 style='height:70.0pt'>\
  <td height=70 class=xl80 style='height:70.0pt;border-top:none'>Books</td>\
  <td class=xl71 style='border-top:none;border-left:none'>Book chapter</td>\
  <td class=xl71 style='border-top:none;border-left:none'>Authors,\
  Illustrations &amp; Maps, Secondary sources,Unpublished work</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>1</td>\
  <td class=xl89 align=right style='border-top:none'>5</td>\
  <td class=xl78 style='border-top:none;border-left:none'>Gibson (2011)<span\
  style='mso-spacerun:yes'>&nbsp;</span></td>\
  <td class=xl79 width=250 style='border-top:none;border-left:none;width:250pt'>Gibson,\
  C. C. (2011).<font class='font9'> </font><font class='font8'>Impact of the\
  larger social context on the distance learner</font><font class='font9'>.</font><font\
  class='font8'> In S. Allsop </font><font class='font0'>(Ed.),</font><font\
  class='font8'> </font><font class='font9'>International Council for</font><font\
  class='font6'> Distance</font><font class='font9'> Education: One world many\
  voices: Quality in open</font><font class='font6'> and</font><font\
  class='font9'> </font><font class='font6'>distance learning</font><font\
  class='font0'><span style='mso-spacerun:yes'>&nbsp;</span>(pp. 279-282).\
  Chicago, IL: Milton Keynes.</font></td>\
  <td class=xl79 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 class=xl80 style='height:14.0pt;border-top:none'>Books</td>\
  <td class=xl71 style='border-top:none;border-left:none'>Brochure</td>\
  <td class=xl71 style='border-top:none;border-left:none'>Authors,\
  Illustrations &amp; Maps, Secondary sources,Unpublished work</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>1</td>\
  <td class=xl89 align=right style='border-top:none'>6</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 class=xl80 style='height:14.0pt;border-top:none'>Books</td>\
  <td class=xl67 style='border-top:none;border-left:none'>Thesis</td>\
  <td class=xl67 style='border-top:none;border-left:none'>Authors,\
  Illustrations &amp; Maps, Secondary sources,Unpublished work</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>1</td>\
  <td class=xl89 align=right style='border-top:none'>7</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 class=xl80 style='height:14.0pt;border-top:none'>Books</td>\
  <td class=xl67 style='border-top:none;border-left:none'>Lecture note</td>\
  <td class=xl67 style='border-top:none;border-left:none'>Authors,\
  Illustrations &amp; Maps, Secondary sources,Unpublished work</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>1</td>\
  <td class=xl89 align=right style='border-top:none'>8</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr class=xl105 height=14 style='height:14.0pt'>\
  <td height=14 class=xl101 style='height:14.0pt;border-top:none'>Authors</td>\
  <td class=xl102 style='border-top:none;border-left:none'>Single author</td>\
  <td class=xl102 style='border-top:none;border-left:none'>&nbsp;</td>\
  <td class=xl102 align=right style='border-top:none;border-left:none'>7</td>\
  <td class=xl103 align=right style='border-top:none'>1</td>\
  <td class=xl102 style='border-top:none;border-left:none'>&nbsp;</td>\
  <td class=xl104 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl104 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl102 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 class=xl66 style='height:14.0pt;border-top:none'>Authors</td>\
  <td class=xl67 style='border-top:none;border-left:none'>Organisation/Institution</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>7</td>\
  <td class=xl89 align=right style='border-top:none'>2</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 class=xl66 style='height:14.0pt;border-top:none'>Authors</td>\
  <td class=xl67 style='border-top:none;border-left:none'>Two authors</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>7</td>\
  <td class=xl89 align=right style='border-top:none'>3</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=42 style='height:42.0pt'>\
  <td height=42 class=xl80 style='height:42.0pt;border-top:none'>Authors</td>\
  <td class=xl71 style='border-top:none;border-left:none'>Three till five\
  authors</td>\
  <td class=xl98 style='border-left:none'>&nbsp;</td>\
  <td class=xl91 align=right style='border-left:none'>7</td>\
  <td class=xl92 align=right>4</td>\
  <td class=xl87 width=147 style='border-top:none;border-left:none;width:147pt'>Anderson,\
  Sweeney and Williams (2006, p. xx)<span\
  style='mso-spacerun:yes'>&nbsp;</span></td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>Anderson,\
  D. R., Sweeney, D. J., &amp; Williams, T. A. (2006). <font class='font6'>Quantitative\
  methods for business</font><font class='font0'>. Mason, OH: Thomson.</font></td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=42 style='height:42.0pt'>\
  <td height=42 class=xl80 style='height:42.0pt;border-top:none'>Authors</td>\
  <td class=xl71 style='border-top:none;border-left:none'>Six or more authors</td>\
  <td class=xl71 style='border-top:none;border-left:none'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>7</td>\
  <td class=xl89 align=right style='border-top:none'>5</td>\
  <td class=xl71 style='border-top:none;border-left:none'>Brown et al.\
  (2008)<span style='mso-spacerun:yes'>&nbsp;</span></td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>Brown,\
  D., Harper, H., Frei, M., Ingham, M., Otter, G. Raskin, J., É Delay, A.\
  (2008). <font class='font6'>Basic writing skills</font><font class='font0'>.\
  Toronto, Canada: McGraw-Hill.</font></td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=70 style='height:70.0pt'>\
  <td height=70 class=xl80 style='height:70.0pt;border-top:none'>Authors</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Authors\
  with the same last name</td>\
  <td class=xl99 width=340 style='border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl91 align=right style='border-left:none'>7</td>\
  <td class=xl92 align=right>6</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>(P.\
  M. Anderson, 2003, p. xx)<br>\
  (J. B. Anderson, 2005, p. xx)<br>\
  </td>\
  <td class=xl76 width=250 style='border-top:none;border-left:none;width:250pt'>Anderson,\
  J. B. (2005). <font class='font6'>Digital transmission engineering</font><font\
  class='font0'>. Piscataway, NJ: IEEE Press.<br>\
   Anderson, P. M. (2003). </font><font\
  class='font6'>Analysis of faulted power systems</font><font class='font0'>.\
  Piscataway, NJ: IEEE Press.<span\
  style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\
  </span><br>\
  </font></td>\
  <td class=xl76 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=70 style='height:70.0pt'>\
  <td height=70 class=xl80 style='height:70.0pt;border-top:none'>Authors</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Multiple\
  works by the same author</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>7</td>\
  <td class=xl89 align=right style='border-top:none'>7</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>(Smith,\
  2005, p. xx; 2007, p. yy)<span style='mso-spacerun:yes'>&nbsp;</span></td>\
  <td class=xl76 width=250 style='border-top:none;border-left:none;width:250pt'>Smith,\
  P. (2005). <font class='font6'>Piping Materials Guide</font><font\
  class='font0'>. Oxford, England: Elsevier.<br>\
   Smith, P. (2007). </font><font\
  class='font6'>Process piping design handbook: fundamentals of piping design</font><font\
  class='font0'>. Houston, TX: Gulf.<br>\
  </font></td>\
  <td class=xl76 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=70 style='height:70.0pt'>\
  <td height=70 class=xl80 style='height:70.0pt;border-top:none'>Authors</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Multiple\
  works by the same author in the same year</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>7</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>8</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>(Napier,\
  1993a, p. xx; 1993b, p. yy) É</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>Napier,\
  A. (1993a).<font class='font6'> Fatal storm</font><font class='font0'>.\
  Sydney, Australia: Allen &amp; Unwin.    <br>\
   Napier, A. (1993b). </font><font\
  class='font6'>Survival at sea</font><font class='font0'>. Sydney, Australia:\
  Allen &amp; Unwin.<br>\
  </font></td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=42 style='height:42.0pt'>\
  <td height=42 class=xl80 style='height:42.0pt;border-top:none'>Articles &amp;\
  Papers</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Journal\
  article</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>Authors</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>2</td>\
  <td class=xl89 align=right style='border-top:none'>1</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>(Cutler,\
  2011)</td>\
  <td class=xl76 width=250 style='border-top:none;border-left:none;width:250pt'>Cutler,\
  A. D. (2011). High-Frequency Pulsed Combustion Actuator Experiments. <font\
  class='font6'>AIAA Journal</font><font class='font0'>, </font><font\
  class='font6'>49</font><font class='font0'>(9), 1943-1950.</font></td>\
  <td class=xl76 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 class=xl85 style='height:14.0pt;border-top:none'>Articles &amp;\
  Papers</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Journal\
  article with DOI</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>Authors</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>2</td>\
  <td class=xl89 align=right style='border-top:none'>2</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 class=xl80 style='height:14.0pt;border-top:none'>Articles &amp;\
  Papers</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Newspaper\
  article</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>Authors</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>2</td>\
  <td class=xl89 align=right style='border-top:none'>3</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 class=xl80 style='height:14.0pt;border-top:none'>Articles &amp;\
  Papers</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Online\
  newspaper article</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>Authors</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>2</td>\
  <td class=xl89 align=right style='border-top:none'>4</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 class=xl66 style='height:14.0pt;border-top:none'>Reports</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Printed\
  report</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>3</td>\
  <td class=xl89 align=right style='border-top:none'>1</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=84 style='height:84.0pt'>\
  <td height=84 class=xl80 style='height:84.0pt;border-top:none'>Reports</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Online\
  report</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>3</td>\
  <td class=xl89 align=right style='border-top:none'>2</td>\
  <td class=xl82 width=147 style='width:147pt'>It is stated by Van der Wel and\
  Bergen (2000) É</td>\
  <td class=xl76 width=250 style='border-top:none;width:250pt'>Van der Wel, N.,\
  &amp; Bergen, V. H. S. (2000). <font class='font6'>Plattelandsvernieuwing en\
  cultuur: interactieve planontwikkeling </font><font class='font0'>(NRLO-rapport\
  nr. 2000/8). Retrieved from Innovatie Agro &amp; Natuur website:\
  http://publications.tno.nl/publication/34614835/QuPGHi/NRLO-2000-08.pdf</font></td>\
  <td class=xl76 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 class=xl84 style='height:14.0pt'>On the internet/Social media</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Page\
  on the internet</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>Illustrations\
  &amp; Maps</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>4</td>\
  <td class=xl89 align=right style='border-top:none'>1</td>\
  <td class=xl94 width=147 style='width:147pt'>&nbsp;</td>\
  <td class=xl76 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl76 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=28 style='height:28.0pt'>\
  <td height=28 class=xl80 style='height:28.0pt'>On the internet/Social media</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Company\
  on the internet</td>\
  <td class=xl99 width=340 style='border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl91 align=right style='border-left:none'>4</td>\
  <td class=xl92 align=right>2</td>\
  <td class=xl82 width=147 style='width:147pt'>On the website of Boei (n.d.) É.</td>\
  <td class=xl68 width=250 style='border-top:none;width:250pt'>Boei. (n.d.).\
  Project graansilo. Retrieved May 23, 2017 from\
  http://www.boei.nl/projecten/graansilo-wehl</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 class=xl84 style='height:14.0pt'>On the internet/Social media</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Entry\
  online encyclopedia</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>4</td>\
  <td class=xl89 align=right style='border-top:none'>3</td>\
  <td class=xl76 width=147 style='border-left:none;width:147pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 class=xl84 style='height:14.0pt'>On the internet/Social media</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Podcast</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>4</td>\
  <td class=xl89 align=right style='border-top:none'>4</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 class=xl84 style='height:14.0pt'>On the internet/Social media</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>YouTube</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>4</td>\
  <td class=xl89 align=right style='border-top:none'>5</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 class=xl81 width=199 style='height:14.0pt;width:199pt'>On the\
  internet/Social media</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Web\
  log post/comment</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>4</td>\
  <td class=xl89 align=right style='border-top:none'>6</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=42 style='height:42.0pt'>\
  <td height=42 class=xl83 width=199 style='height:42.0pt;border-top:none;\
  width:199pt'>Patents</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Patents</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>5</td>\
  <td class=xl89 align=right style='border-top:none'>1</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>..É\
  the invention by Bellusci and Janssen (WO 2010/131966 A1, 2010) is an example\
  of .É.</td>\
  <td class=xl82 width=250 style='width:250pt'>Bellusci, G., &amp; Janssen, G.\
  J. M. (2010). <font class='font6'>WO 2010/131966 A1</font><font class='font0'>.\
  Geneva, Switzerland: World Intellectual Property Organization.</font></td>\
  <td class=xl76 width=250 style='border-top:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=56 style='height:56.0pt'>\
  <td height=56 class=xl83 width=199 style='height:56.0pt;border-top:none;\
  width:199pt'>Standards</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Standards</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>6</td>\
  <td class=xl89 align=right style='border-top:none'>1</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>É..\
  In standard NEN 6578:2011 (2011) É..</td>\
  <td class=xl68 width=250 style='border-left:none;width:250pt'>Nederlands\
  Normalisatie Instituut. (2011). <font class='font6'>Water - Potentiometrische\
  bepaling van het totale gehalte aan totaal fluoride NEN 6578:2011</font><font\
  class='font0'>. Delft, The Netherlands: Author.</font></td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=84 style='height:84.0pt'>\
  <td height=84 class=xl83 width=199 style='height:84.0pt;border-top:none;\
  width:199pt'>Illustrations &amp; Maps</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Image\
  in a book</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>8</td>\
  <td class=xl89 align=right style='border-top:none'>1</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>The\
  image ÒLocal scour at piers as illustrated by model experiment and pir\
  failureÓ (Transportation Association of Canada, 2004, p. 68) is É</td>\
  <td class=xl76 width=250 style='border-top:none;border-left:none;width:250pt'>Transportation\
  Association of Canada. (2004). <font class='font6'>Guide to bridge hydraulics</font><font\
  class='font0'><span style='mso-spacerun:yes'>&nbsp;</span>(2nd ed.). London,\
  England: Telford.</font></td>\
  <td class=xl76 width=250 style='border-top:none;border-left:none;width:250pt'>Figure\
  X.  Local scour at piers as illustrated by model experiment and pir failure.\
  From <font class='font6'>Guide to bridge hydraulics </font><font class='font0'>(2nd\
  ed., p. 68), by Transportation Association of Canada, 2004, London, England:\
  Telford. Copyright 2004 by Transportation Association of Canada.</font></td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=56 style='height:56.0pt'>\
  <td height=56 class=xl83 width=199 style='height:56.0pt;border-top:none;\
  width:199pt'>Illustrations &amp; Maps</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Image\
  on a website</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>8</td>\
  <td class=xl89 align=right style='border-top:none'>2</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>As\
  shown in figure 7, Houston is one of the cities In the USA with a light rail\
  systemÉ</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>Haase,\
  M. (2006). Light rail Houston [Photograph]. Retrieved from\
  https://commons.wikimedia.org/wiki/File:Light_Rail_Houston.jpg</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>Figure\
  X: Light rail Houston. From Ò<font class='font6'>Wikimedia Commons,</font><font\
  class='font0'>Ó by M. Haase, 2006\
  (https://commons.wikimedia.org/wiki/File:Light_Rail_Houston.jpg). Licensed\
  under CC BY 2.5</font></td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=15 style='height:15.0pt'>\
  <td height=15 class=xl81 width=199 style='height:15.0pt;border-top:none;\
  width:199pt'>Illustrations &amp; Maps</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Online\
  maps</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>8</td>\
  <td class=xl89 align=right style='border-top:none'>3</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=15 style='height:15.0pt'>\
  <td height=15 class=xl83 width=199 style='height:15.0pt;border-top:none;\
  width:199pt'>Secondary sources</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Book</td>\
  <td class=xl76 width=340 style='border-top:none;border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl67 align=right style='border-top:none;border-left:none'>9</td>\
  <td class=xl89 align=right style='border-top:none'>1</td>\
  <td class=xl95 width=147 style='width:147pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;width:250pt'>&nbsp;</td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=56 style='height:56.0pt'>\
  <td height=56 class=xl83 width=199 style='height:56.0pt;border-top:none;\
  width:199pt'>Unpublished work</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Paper\
  book</td>\
  <td class=xl100 width=340 style='border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl90 align=right style='border-left:none'>10</td>\
  <td class=xl93 align=right style='border-top:none;border-left:none'>1</td>\
  <td class=xl76 width=147 style='border-left:none;width:147pt'>Blackwell and\
  Conrod (2003)</td>\
  <td class=xl76 width=250 style='border-top:none;border-left:none;width:250pt'>Blackwell,\
  E., &amp; Conrod, P. J. (2003). <font class='font6'>A five-dimesional measure\
  of drinking </font><font class='font0'>motives. Unpublished manuscript,\
  Department of Psychology, University of British Colombia, Vancouver, Canada.</font></td>\
  <td class=xl68 width=250 style='border-top:none;border-left:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=56 style='height:56.0pt'>\
  <td height=56 class=xl83 width=199 style='height:56.0pt;border-top:none;\
  width:199pt'>Unpublished work</td>\
  <td class=xl76 width=143 style='border-top:none;border-left:none;width:143pt'>Situation\
  sketch</td>\
  <td class=xl76 width=340 style='border-left:none;width:340pt'>&nbsp;</td>\
  <td class=xl67 align=right style='border-left:none'>10</td>\
  <td class=xl89 align=right>2</td>\
  <td class=xl76 width=147 style='border-top:none;border-left:none;width:147pt'>Based\
  on Jansen (2017)É.</td>\
  <td class=xl82 width=250 style='width:250pt'>Jansen, H. H. (2017). <font\
  class='font6'>Stationsgebied Rotterdam</font><font class='font0'><span\
  style='mso-spacerun:yes'>&nbsp;</span>[Situatieschets]. Unpublished,\
  Department of Architecture, University of Technology, Delft, The Netherlands.</font></td>\
  <td class=xl68 width=250 style='border-top:none;width:250pt'>&nbsp;</td>\
  <td class=xl67 style='border-top:none;border-left:none'>&nbsp;</td>\
 </tr>\
 <tr height=42 style='height:42.0pt;mso-xlrowspan:3'>\
  <td height=42 colspan=9 style='height:42.0pt;mso-ignore:colspan'></td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 class=xl72 style='height:14.0pt'></td>\
  <td colspan=8 style='mso-ignore:colspan'></td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 colspan=9 style='height:14.0pt;mso-ignore:colspan'></td>\
 </tr>\
 <tr height=14 style='height:14.0pt'>\
  <td height=14 class=xl86 style='height:14.0pt'></td>\
  <td colspan=8 style='mso-ignore:colspan'></td>\
 </tr>\
</table>\
\
</body>\
\
</html>\
"

	  function getDummyFile() {
		/*
		$("#testFile").on("getTest", function(event, param1) {
			console.log(param1);
		});
		console.log('getfile');
		$('#testFile').trigger("getTest",'dd');
		*/
		var f = new File([fileContent], "filename.txt", {type: "text/plain", lastModified: new Date()});
		//console.log(f);
       	var reader = new FileReader();
       	reader.readAsText(f);
       	reader.onload = function(event) {
			try {
               	data = event.target.result;
				apaContent = toJSON(data);
				addStyle(data);
				showHeadingOptions(apaContent);
				showTypeOptions(apaContent);
				showCombinesWith(apaContent);
				showExamples(apaContent);
				$('#select-heading').focus();
			}
			catch(err) {
				console.log(err);
			}
		}
	}
	getDummyFile();
	// end get dummy file for testing purposes
	
	// start getting json Dummy for testing purposes
	function getJsonDummy() {
		try {
			//console.log(jsonDummy.replace(/\t/g,"").replace(/\n/g,"").replace(/\\"/g,"\'").replace(/="/g,"='").replace(/">/g,"'>"));
			apaContent = JSON.parse(jsonDummy.replace(/\t/g,"").replace(/\n/g,"").replace(/\\"/g,"\'").replace(/="/g,"='").replace(/">/g,"'>"));
			addStyle(apaContent);
			apaContent = getSortedContentWithChangedId(apaContent);
			showHeadingOptions(apaContent);
			showTypeOptions(apaContent);
			showCombinesWith(apaContent);
			showExamples(apaContent);
			$('#select-heading').focus();
		}
		catch(err) {
			console.log(err);
		}
	}
	//getJsonDummy();
	// end getting json Dummy for testing purposes
	
	// start showing the combination options
	function showCombinesWith(apaContent) {
		try {
			var combinesWithResult = '';
			var combinesWithList = {};
			var combinesWithHeading = $('#headingoptions :selected').text();
			var combinesWithType = $('#typeoptions :selected').text();
			var combinesWithColumn = nameToKey(apaContent.header, "Combines with");
			$.each(apaContent.content, function(cIndex, cValue){
				if ((combinesWithHeading == cValue[nameToKey(apaContent.header, "Heading")]) && (combinesWithType == cValue[nameToKey(apaContent.header, "Types")])) {
					$.each(cValue[combinesWithColumn].split(','), function(aIndex, aValue) {
						if (aValue.replace(/\s+/g, "") != "") {
							combinesWithList[aValue] = aValue + "<hidden id=" + cValue.id + "</hidden>";
						}
					});
				}
			});
			$.each(combinesWithList, function(index, value) {
				combinesWithResult += value + '<br>';
			});
			if (combinesWithResult == "") {
				$('#combinationoptions-title').hide();
			}
			else {
				$('#combinationoptions-title').show();			
			}
			$('#combinationoptions').html(combinesWithResult);
		}
		catch (err) {
			console.log(err);
		}
	}
	// end showing the combination options
	
	// start showing the heading options so users can pick a value for getting a corrsponding type-list
	function showHeadingOptions(apaContent) {
		try {
			var headingoptions = '<select id="select-heading" size="6"><br>';  // options for selecting a list of type-options
			var headinglist = {};
			var size = 0;
			$.each(apaContent.content, function(cIndex, cValue){
				var key = cValue.id.split("_")[0];
				$.each(cValue, function(index, value){
					if (index == 0) {						// 0 = headings
						headinglist[key] = value;
					}
				});
			});
			$.each(headinglist, function(index, value){
				var selected = "";
				if (index == 0) {							// first element
					selected = " selected ";
				}
				headingoptions += '<option value="' + index + '"' + selected + '>' + value + '</option><br>';
				size += 1;
			});
			headingoptions += '</select><br>';
			headingoptions = headingoptions.replace(/"6"/, '"' + size + '"');
			$('#headingoptions').html(headingoptions);
		}
		catch(err) {
			console.log(err);
		}
	} 
	// end showing the heading options so users can pick a value for getting a corrsponding type-list

	// start showing the type options so users can pick a value for getting a corresponding content
	function showTypeOptions(apaContent) {
		try {
			var typeoptions = '<select id="select-type" size="6"><br>'     // options for a type belonging to the selected header-option
			var typelist = {};
			var size = 0;
			$.each(apaContent.content, function(cIndex, cValue){
				var selectedHeading = $('#headingoptions :selected').val();
				var key = cValue.id;
				var headingKey = cValue.id.split("_")[0];
				$.each(cValue, function(index, value){
					if (headingKey == selectedHeading) {
						if (index == 1) {						// 1 = type
							typelist[key] = value;
						}
					}
				});
			});
			$.each(typelist, function(index, value){
				var selected = "";
				if (index.split("_")[1] == pad(0,3)) {					// first element
					selected = " selected ";
				}
				typeoptions += '<option value="' + index + '"' + selected + '>' + value + '</option><br>';
				size += 1;
			});
			typeoptions += '</select><br>';
			if (size > 6) {
				typeoptions = typeoptions.replace(/"6"/, '"' + size + '"');
			}
			$('#typeoptions').html(typeoptions);
		}
		catch(err) {
			console.log(err);
		}
	} 
	// end showing the type options so users can pick a value for getting a corresponding content
	
	// start showing the examples
	function showExamples(apaContent, recordId) {
		try {
			$.each(apaContent.content, function(cIndex, cValue){
				if (cValue.id == recordId) {
					$.each(cValue, function(index, value){
						if (index == nameToKey(apaContent.header, "In-tekst example")) {			// In-text example
							$('#in-text-example').html(value);
						}
						if (index == nameToKey(apaContent.header, "Reference list example")) {		// Reference-list example
							$('#reference-list-example').html(value);
						}
						if (index == nameToKey(apaContent.header, "Figure heading example")) {		// Figure heading example
							$('#figure-heading-example').html(value);
						}
						if (index == nameToKey(apaContent.header, "Remark")) {						// Remark
							$('#remark').html(value);
						}
					});
				}
			});
		}
		catch(err) {
			console.log(err);
		}
	} 
	// end showing the examples
	
	function wrapReferenceExample(item) {
		// prevHeight is a global variable and is initially set in headingoptions and typeoptions click-events
		var insertPart = '<br>&nbsp;&nbsp;&nbsp;&nbsp;';
		var re = new RegExp(insertPart, 'g');
		prevHeight = referenceHeight;




//Nederlands Normalisatie Instituut. (2011). <font class="font6">Water - Potentiometrische bepaling van het totale gehalte aan totaal fluoride NEN 6578:2011</font><font class="font0">. Delft, The Netherlands: Author.</font>


		// start save content in an array an empty the reference field
		var specialDelimiter = "-=avdk2017=-";
		var reSpecial = new RegExp(specialDelimiter, 'g');
		var editedItem = $(item).html();
		editedItem = editedItem.replace(/(<font.*?)\s+(.*?>)/g,"$1" + specialDelimiter + "$2");
		editedItem = editedItem.replace(/(<span.*?)\s+(style.*?>)/g,"$1" + specialDelimiter + "$2");
		textArray = editedItem.replace(/\s+/g," ").replace(re, "").split(' ');
		$('#reference-list-example').html("");
		// end save content in an array an empty the reference field

		var newItem = "";
		// building up word by word and check if the height changes
			
		var spliceIndentArray = [];		// holds the numbering of words, and decides where to insert an indent
		for (i = 0; i < textArray.length; i++) {
			//console.log('1: ' + spliceIndentArray.length + " " + textArray.length);
			newItem += textArray[i].replace(insertPart, "") + " ";
			$('#reference-list-example').html(newItem);			
			if (prevHeight < $('#reference-list-example').height()) {
				spliceIndentArray.push(i);
				prevHeight = $('#reference-list-example').height();
			}
		}

		// start empty the reference field, insert the insertPart and set reference-list-example
		//console.log('spliceIndentArray: ' + spliceIndentArray);
		newItem = "";
		for (i = 0; i < spliceIndentArray.length; i++) {
			textArray.splice(spliceIndentArray[i], 0, insertPart);
		}
		for (i = 0; i < textArray.length; i++) {
			newItem += textArray[i].replace(reSpecial," ") + " ";
		}
		newItem = newItem.replace(specialDelimiter," ");
		$('#reference-list-example').html(newItem);

		// start check for an extra line after inserting the insertPart and compensate if needed
		//console.log("laatste height: " +  $('#reference-list-example').height());
		if (prevHeight < $('#reference-list-example').height()) {
			newItem = "";
			if (textArray.length > 1) {
				textArray.splice(textArray.length - 2, 0, insertPart);
			}
			for (i = 0; i < textArray.length; i++) {
				newItem += textArray[i].replace(reSpecial," ") + " ";
			}
			
			$('#reference-list-example').html(newItem);	
			prevHeight = $('#reference-list-example').height();
		}
		// end check for an extra line after inserting the insertPart and compensate if needed


		// end empty the reference field, insert the insertPart and set reference-list-example
	}
	
	function startEvents(){
		$('#toggleExample').off('click').on('click', function(){
			$('#example').toggle();
			if ($('#example').is(':visible')) {
				$(this).text('(voorbeeld inklappen)');
			}
			else {
				$(this).text('(voorbeeld uitklappen)');
			}
		});
		$('#headingoptions').off('keyup').on('keyup', function(e){
			if (e.which == 39) {
				//console.log("right");
				$('#select-type').focus();
			}
		});
		$('#typeoptions').off('keyup').on('keyup', function(e){
			if (e.which == 37) {
				//console.log("left");
				$('#select-heading').focus();
			}
		});
		$('#headingoptions').off('change').on('change', function(){
			showTypeOptions(apaContent);
			var recordId = $('#typeoptions :selected').val();
			showExamples(apaContent, recordId);
			showCombinesWith(apaContent);
			prevHeight = referenceHeight;				// see wrapReferenceExample
			wrapReferenceExample($('#reference-list-example'));
			//showAppliesToOptions(apaContent);
			$('#select-type').focus();
			$('#select-heading').focus();
		});
		$('#typeoptions').off('change').on('change', function(){
			var recordId = $('#typeoptions :selected').val();
			showExamples(apaContent, recordId);
			showCombinesWith(apaContent);
			prevHeight = referenceHeight;				// see wrapReferenceExample
			wrapReferenceExample($('#reference-list-example'));
			//showAppliesToOptions(apaContent);
		});
		/* niet meer in gebruik
		$('#combinationoptions').off('click').on('click', function(){
			var recordId = $('#combinationoptions :selected').val();
			showExamples(apaContent, recordId);
			// ?? Hier nog de heading en type weer aanplassen zodat het circulair wordt ??
			//showAppliesToOptions(apaContent);
		});
		*/
		
		$(window).off('resize').on('resize', function(){
			wrapReferenceExample($('#reference-list-example'));
		});
	};


	$(function initFunctions(){
		$("#example").hide();
		startEvents();
		$('#headingoptions').trigger('change');
	});


	
});
</script>
</body>
</html>
